# 并查集

```js
  const accountsMerge = (accounts) => {
    const emailToIndex = new Map()
    const emailToName = new Map()
    let emailsCount = 0
    for (const account of accounts) {
      const name = account[0]
      const size = account.length
      for (let i = 1; i < size; i += 1) {
        const email = account[i]
        if (!emailToIndex.has(email)) {
          emailToIndex.set(email, emailsCount += 1)
          emailToName.set(email, name)
        }
      }
    }

    const uf = new UnionFind(emailsCount)
    for (const account of accounts) {
      const firstEmail = account[1]
      const firstIndex = emailToIndex.get(firstEmail)
      const size = account.length
      for (let i = 2; i < size; i += 1) {
        const nextEmail = account[i]
        const nextIndex = emailToIndex.get(nextEmail)
        uf.union(firstIndex, nextIndex)
      }
    }
    console.log('uf: ', uf)

    const indexToEmails = new Map()
    for (const email of emailToIndex.keys()) {
      const index = uf.find(emailToIndex.get(email))
      const account = indexToEmails.get(index) ? indexToEmails.get(index) : []
      account.push(email)
      indexToEmails.set(index, account)
    }
    const merged = []
    for (const emails of indexToEmails.values()) {
      emails.sort()
      const name = emailToName.get(emails[0])
      const account = []
      account.push(name)
      account.push(...emails)
      merged.push(account)
    }
    return merged
  }

  class UnionFind {
    constructor(n) {
      this.parent = new Array(n).fill(0).map((element, index) => index)
    }

    union(index1, index2) {
      this.parent[this.find(index2)] = this.find(index1)
    }

    find(index) {
      if (this.parent[index] !== index) {
        this.parent[index] = this.find(this.parent[index])
      }
      return this.parent[index]
    }
  }

  const accounts = [
    ['Gabe', 'Gabe0@m.co', 'Gabe3@m.co', 'Gabe1@m.co'],
    ['Kevin', 'Kevin3@m.co', 'Kevin5@m.co', 'Kevin0@m.co'],
    ['Ethan', 'Ethan5@m.co', 'Ethan4@m.co', 'Ethan0@m.co'],
    ['Hanzo', 'Hanzo3@m.co', 'Hanzo1@m.co', 'Hanzo0@m.co'],
    ['Fern', 'Fern5@m.co', 'Fern1@m.co', 'Fern0@m.co'],
  ]
  console.log(accountsMerge(accounts))
```
