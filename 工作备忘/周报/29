【周报】岳鹏飞 2022/6/19

<fe@lenovocloud.com>;
xuyb@lenovocloud.com;<wangzy@lenovocloud.com>;<yuanlei@lenovocloud.com>;

本周工作内容
  1.开放平台showcase / 提测
  2.信创2022问题修复
  3.定位修复线上遗留问题

下周工作安排
  1. 信创2022问题修复
  2. 信创2022二轮提测 web&server(6.21) web&客户端(6.26)

思考体会
  不遵循MR约定所产生的问题
  信创2022对web,view,doc_preview三个项目做了代码合并, 也做了几轮review, 依然存在几处代码漏合的问题. 在web项目中, 少了`dm_set_connect(12345,1,$this->link);`这段代码. dm_set_connect: 设置连接; 这段代码的缺失, 导致部署完毕容器重启之后,在不重启php的情况下,无法连接达梦数据库.
  梳理流程找了具体一下原因:
  1. 定位更改所在的分支;
    在FEDEV-305分支做了更改"commit<6243d4bda03c1eab4f3eacd9c09c313cee460123>", 并且通过Merge方式合入"zhuque-2021-patch2".
  2. 查找MR记录, 对比commit;
    在gitlab的MR记录中查询以"FEDEV-305"为标题的合并记录, 只查询到一处"commit<28772044fcd7c21615f33031cc65aca71753cd3c>", 但是并没有包含这段代码的修改.
    之前整理的信创变更(信创特性)工单就到了这一步, 没有再向下查找. 也就是从这一步开始代码被漏掉了.
  3. 找到丢失的commit记录;
    从分支"zhuque-2021-patch2"的合并记录查找
    从gitlab仓库的MR记录找到对应的合并历史
  由此,可以确定代码漏掉的原因是:
    1. 合并FEDEV-305分支的代码时, MR的标题未按照规范命名. 有的使用 feat(分支名) 有的使用 feat(变更描述), 不够统一.
    2. 我在整理信创特性变更时, 整理出2条"FEDEV-305"分支的合并记录, 当时想着一个分支的MR title应该保持一致,就只保留一条记录. 没有做深入的整理.
  如何规避:
    1. 在代码的生命周期内, 严格按照规范和规范去命名. 尽量让MR的title规范一致.
    2. 做内容整理时, 要尽可能的详细, 确保每一处变更能够得到正确的追溯.

其他周知事项
  无
